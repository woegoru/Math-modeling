#ĞšĞ¾Ğ±ÑÑˆĞ¾Ğ²Ğ° Ğ”Ğ°Ñ€ÑŒÑ ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€Ğ¾Ğ²Ğ½Ğ° 3 ĞºÑƒÑ€Ñ 4 Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ°

#ĞĞ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹ Ğ´Ğ»Ñ Ğ½Ğ°Ñ…Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¼ĞµĞ¶ÑƒÑ‚Ğ¾Ñ‡Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ Ğ¸ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸, Ğ·Ğ°Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ² n Ñ‚Ğ¾Ñ‡ĞºĞ°Ñ…:
#Ğ¿Ğ¾ÑÑ€ĞµĞ´ÑÑ‚Ğ²Ğ¾Ğ¼ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ»Ğ¸Ğ½Ğ¾Ğ¼Ğ° Ğ›Ğ°Ğ³Ñ€Ğ°Ğ½Ğ¶Ğ°.
#ĞœĞ½Ğ¾Ğ³Ğ¾Ñ‡Ğ»ĞµĞ½ Ğ›Ğ°Ğ³Ñ€Ğ°Ğ½Ğ¶Ğ° Ğ¸Ñ‰ĞµÑ‚ÑÑ Ğ² Ğ²Ğ¸Ğ´Ğµ Ğ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ Ğ¸Ğ· Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğ‘¦ = ğ‘“(ğ‘¥) Ğ² ğ‘–-Ñ‹Ñ… ÑƒĞ·Ğ»Ğ°Ñ… Ğ¸Ğ½Ñ‚ĞµÑ€Ğ¿Ğ¾Ğ»ÑÑ†Ğ¸Ğ¸ Ğ¸ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ñ… 
#Ğ¸Ğ· ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ ÑƒĞ·Ğ»Ğ¾Ğ² Ğ¸Ğ½Ñ‚ĞµÑ€Ğ¿Ğ¾Ğ»ÑÑ†Ğ¸Ğ¸ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ñ‡Ğ»ĞµĞ½Ğ¾Ğ² ğ¿ğ‘›(ğ‘¥) ğ‘› -Ğ¾Ğ¹ ÑÑ‚ĞµĞ¿ĞµĞ½Ğ¸


import matplotlib.pyplot as plt 
import numpy as np
from generanor import *

def data_read(path: str): #Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¸Ğ· Ñ„Ğ°Ğ¹Ğ»Ğ°
    f = open(path, 'r')
    l = f.readline() #Ñ‡Ñ‚ĞµĞ½Ğ¸Ğµ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¸
    data = list()
    while(l):
        x = [float(num) for num in l.split('\n')[0].split(', ')] #Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ· ÑÑ‚Ñ€Ğ¾ĞºĞ¸ ÑĞ¿Ğ¸ÑĞ¾Ğº Ñ‡Ğ¸ÑĞµĞ» Ğ´Ğ»Ñ Ñ…
        l = f.readline() #Ñ‡Ñ‚ĞµĞ½Ğ¸Ğµ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¸
        y = [float(num) for num in l.split('\n')[0].split(', ')] #Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ· ÑÑ‚Ñ€Ğ¾ĞºĞ¸ ÑĞ¿Ğ¸ÑĞ¾Ğº Ñ‡Ğ¸ÑĞµĞ» Ğ´Ğ»Ñ Ñƒ
        data.append([x, y])
        l = f.readline() #Ñ‡Ñ‚ĞµĞ½Ğ¸Ğµ ÑÑ‚Ñ€Ğ¾ĞºĞ¸-Ñ€Ğ°Ğ·Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ¸Ñ‚ĞµĞ»Ñ
        l = f.readline() #Ñ‡Ñ‚ĞµĞ½Ğ¸Ğµ ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ¹(Ğ½Ğ¾Ğ²Ğ¾Ğ¹ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¹) ÑÑ‚Ñ€Ğ¾ĞºĞ¸
    return data

def interpol(data, x_found):
        for i in range(len(data)):
            func = 0
            y_interpol = 0
            x = np.linspace(data[i][0][0], data[i][0][-1]) #Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»Ğ°
            for j in range(len(data[i][0])): #Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ¾Ğ´Ğ½Ğ¾Ğ¼Ñƒ Ğ½Ğ°Ğ±Ğ¾Ñ€Ñƒ
                numerator = 1
                numerator_ = 1
                denominator = 1 
                for k in range(len(data[i][0])):
                    if k != j:
                        numerator *= x - data[i][0][k] #Ğ²Ñ‹Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ĞµĞ»Ñ
                        numerator_ *= x_found - data[i][0][k] #Ğ²Ñ‹Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ĞµĞ»Ñ
                        denominator *= data[i][0][j] - data[i][0][k] #Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ½Ğ°Ğ¼ĞµĞ½Ğ°Ñ‚ĞµĞ»Ñ
                func += data[i][1][j] * (numerator/denominator) #Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ñ‡Ğ»ĞµĞ½Ğ° Ğ›Ğ°Ğ³Ñ€Ğ°Ğ½Ğ¶Ğ°   
                y_interpol += data[i][1][j] * (numerator_/denominator)
            plt.plot(x, func, c='k') #ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾Ñ‡ĞµĞº 
            if x_found >= min(data[i][0]) and x_found <= max(data[i][0]):
                plt.scatter(x_found, y_interpol, c='r', marker='*', s= 150) #Ğ¸ÑĞºĞ¾Ğ¼Ğ°Ñ Ñ‚Ğ¾Ñ‡ĞºĞ°
            plt.scatter(data[i][0], data[i][1]) #Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ°Ğ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
        plt.show()

print('Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ x Ğ¸ÑĞºĞ¾Ğ¼Ğ¾Ğ¹ Ñ‚Ğ¾Ñ‡ĞºĞ¸')
x_found = float(input())

interpol(data_read('task3/task3.3.txt'), x_found)